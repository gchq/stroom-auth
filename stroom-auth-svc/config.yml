server:
  registerDefaultExceptionMappers: false
  adminMinThreads: 1
  adminMaxThreads: 10
  adminContextPath: ${ADMIN_CONTEXT_PATH:- /}
  applicationContextPath: ${APPLICATION_CONTEXT_PATH:- /}
  applicationConnectors:
    - type: ${APPLICATION_CONNEXTOR_TYPE:- http}
      port: ${APPLICATION_CONNEXTOR_PORT:- 8099}
  adminConnectors:
    - type: ${ADMIN_CONNEXTOR_TYPE:- http}
      port: ${ADMIN_CONNEXTOR_PORT:- 8100}

database:
  driverClass: org.mariadb.jdbc.Driver
  user: ${DB_USER:- stroomuser}
  password: ${DB_PASSWORD:- stroompassword1}
  url: ${DB_URL:- jdbc:mariadb://localhost:3309/auth}
  properties:
    charSet: UTF-8
    hibernate.dialect: org.hibernate.dialect.MySQLInnoDBDialect
    hibernate.show_sql: false

logging:
  level: ${LOGGING_LEVEL:- ERROR}
  loggers:
    stroom: DEBUG
    io.dropwizard: INFO
    org.eclipse.jetty: INFO
    org.flywaydb: INFO
  appenders:
    - type: console
      logFormat: "%-6level [%d{HH:mm:ss.SSS}] [%t] %logger{5} - %X{code} %msg %n"
      timeZone: UTC

jooq:
  dialect: MYSQL
  logExecutedSql: yes
  renderSchema: yes
  renderNameStyle: QUOTED
  renderKeywordStyle: LOWER
  renderFormatted: no
  paramType: INDEXED
  statementType: PREPARED_STATEMENT
  executeLogging: no
  executeWithOptimisticLocking: no
  attachRecords: yes
  updatablePrimaryKeys: no

token:
  minutesUntilExpirationForUserToken: ${JWS_MINUTES_UNTIL_EXPIRATION_FOR_USER_TOKEN:- 43200} # 43200 minutes = 30 days
  minutesUntilExpirationForApiToken: ${JWS_MINUTES_UNTIL_EXPIRATION_FOR_API_TOKEN:- 525600} # 525600 minutes = 1 year
  minutesUntilExpirationForEmailResetToken: ${JWS_MINUTES_UNTIL_EXPIRATION_FOR_EMAIL_RESET_TOKEN:- 5} # 5 minutes - short validity for the token
  jwsIssuer: ${JWS_ISSUER:- stroom}
  # Corresponding public key: {"kty":"RSA","kid":"k1","n":"uMF7JkZQDWvC9N0T1sw__7Tdaq0L34ghFBrKq7CkW-LiibQXh3eXBJtNPriDZ7QT4wA23jDF6Bq28RhEyWSssCqrm1Fjvq2ck5dd1shrqR-9WXBs0T1gXi4Mbne3aiWSWFHyW17qjEFoQfx9tLAX9eJYR56KpEu7Au6PAL_9ThQFlQy9wx5Dss8SQy6uwA9qw9A9lCGJKDhRwwBlXZ_5mJSWqqjNSz7ptIKAWvjOVTG8MmgOKqme9RLnWpQnNRf6h9ILK4wixAYLMQpIRphc9tFlZdhiy2yqcdiAEktCF7U0ZcnY3fN_-dw-VEHaCdUoBAPNqBsDPx9ewB8-wtyApQ","e":"AQAB"}
  jwsSecret: >
    ${JWS_SECRET:- {"kty":"RSA","kid":"k1","n":"uMF7JkZQDWvC9N0T1sw__7Tdaq0L34ghFBrKq7CkW-LiibQXh3eXBJtNPriDZ7QT4wA23jDF6Bq28RhEyWSssCqrm1Fjvq2ck5dd1shrqR-9WXBs0T1gXi4Mbne3aiWSWFHyW17qjEFoQfx9tLAX9eJYR56KpEu7Au6PAL_9ThQFlQy9wx5Dss8SQy6uwA9qw9A9lCGJKDhRwwBlXZ_5mJSWqqjNSz7ptIKAWvjOVTG8MmgOKqme9RLnWpQnNRf6h9ILK4wixAYLMQpIRphc9tFlZdhiy2yqcdiAEktCF7U0ZcnY3fN_-dw-VEHaCdUoBAPNqBsDPx9ewB8-wtyApQ","e":"AQAB","d":"b22RvoXNpiqGDHSBkJzjRG9q0vnHHWvWt29pKJ-CoUB3bKHHRxajaE3aCqfx6Mu86r2oWd2EnvXtu_7tDaHAXQd_NE-kHs5KjuFN4UpDVF8mLhkWKCQiSOrw6Hcfkc9TMh1KVD0srKaOIK4Nirph2RRINfmymGBsS9phOQyR01JNInQuDYNSgoDT-Uv1PjzHwD3AuJgiDV37OlASbAGGsb3LQQNUAuBIU6Hqo_hb7RZmi7P5QJnvsiMRr99TlFBoRfVrrFz4TCxQ24FidHGdSbCRW3vMku16zFYdoH1YZzNhkH0SzMunI2Gb2kOok7HSnY40vG9d0dXR7pxg6_2niQ","p":"5_w4aycxflrmrrm1lJjRU0MCvuQA5vY563E-iUKJvALh0WUOgyD_POsMWCYhQtk0nsCk6cMOakGwEauDNgNHgqXU7wA5VyRozZQI6ksf3e_FIqbuf37xfRVEV7XzGLq0l-g0bjG5DDGQW6Nv_61JDmyp-e_Yl-7rZbFNNKNk2Wc","q":"y-GlO8LXW8ymJDuBopC5BUVcwRx9rKOYgOyHu5Ds2X9w6JdB_fVRnua_cjkzaWhCKNfBOAnapnHms9SMCvYf69cSJh5xh5-IU7ngiw_EtBBMMUIZY1OQ_h8VIslrZEkEO7qQia8txW8_zgssbmyYFHc1O0QQ3tMm-2ZRwEkb8hM","dp":"VzHlHtlvb_fIxxnEV2MNIseIK6nVcPpRkN5SzBK3ZHSM3kCmsMDhTstmK2fBjrfHYHg2RCrtqyCfhjS6L74Rzdh47ZBe_RMRVVvz8eRkyO2LYlfuQvu61vH8ax9XjQ74PDSqKFUGIcAra1ZGDYrbb9GGHgx5k7nYvrNiuotDp7c","dq":"FpUQszTam71oLZ01t6bmB3JuWqloNiYMr0MDqb_crB6Uh_6w_Ysdlkcir2ksi6FTqqhzK1zUDhmRnxuMw24NjRbOWNCIbKg79mIhP-XoOLWRaudSXpET_0G8GpVKwtnfkSoR9l4j6LlwzMaqDjUTBzlI-R6J69RhffkQVwcCBGc","qi":"hnETo3IUbiqhIzvmRUUBAjD3IgFxjhNEGCQ7jTtGAcghowFtl_AKg6R80IAsA1EJNBcii7vUE3GePiFCkgGUfQrm3P-ovmI4rmD7xJcpZpnNyYVLJQWYlu4gOow__R_uLffmHYQIakjPe7BTEDqxl1VVGP1k3sm1avI4xF2QvdA"}}
  requireExpirationTime: ${JWS_REQUIRE_EXPIRATION_TIME:- false}
  algorithm: ${JWS_ALGORITHM:- HS256}

certificateDnPattern: ${CERTIFICATE_DN_PATTERN:- CN=[^ ]+ [^ ]+ \(?([a-zA-Z0-9]+)\)?}
loginUrl: ${AUTH_UI:- http://localhost:5000/login}
stroomUrl: ${STROOM_UI:- http://localhost:8099}
resetPasswordUrl: ${RESET_PASSWORD_URL:- 'http://localhost/resetPassword/?token=%s'}
advertisedHost: ${ADVERTISED_HTTP_HOST:- http://localhost}
failedLoginLockThreshold: ${FAILED_LOGIN_LOCK_THRESHOLD:- 3}
sessionIdCookieMaxAge: ${SESSION_ID_COOKIE_MAX_AGE:- 2592000} # 2592000 = 1 month

authorisationService:
  url: ${AUTHORISATION_SERVICE_URL:- http://localhost:8080/api/authorisation/v1}
  canManageUsersPath: ${AUTHORISATION_SERVICE_CAN_MANAGE_USERS_PATH:- /canManageUsers}
  canManageUsersPermission: ${AUTHORISATION_SERVICE_CAN_MANAGE_USERS_PERMISSION:- Manage Users}

email:
  fromAddress: ${EMAIL_FROM_ADDRESS:- noreply@stroom.com}
  fromName: ${EMAIL_FROM_NAME:- Stroom User Accounts}
  passwordResetSubject: ${EMAIL_RESET_SUBJECT:- Password reset for Stroom}
  passwordResetText: ${EMAIL_RESET_TEXT:- 'A password reset has been requested for this email address. Please visit the following URL to reset your password: %s.'}
  passwordResetTokenValidityInMinutes: ${EMAIL_RESET_TOKEN_VALIDITY_IN_MINUTES:- 5}
  smtp:
    host: ${EMAIL_SMTP_HOST:- smtp.gmail.com}
    port: ${EMAIL_SMTP_PORT:- 587}
    transport: ${EMAIL_SMTP_TRANSPORT:- TLS} # Possible values: TLS, SSL, plain. Defaults to plain if unspecified.
    username: ${EMAIL_SMTP_USERNAME:- TODO}
    password: ${EMAIL_SMTP_PASSWORD:- TODO}